Jigar, ajoyib! Bu o‚Äòta muhim qadam. Yangi dasturchiga yoki boshqa AI tizimiga loyihani tushuntirish uchun strukturaviy, texnik fokusli hujjat kerak.Mana, sizning "Vegas CRM Backend" loyihangizning arxitekturaviy tushuntirishi (Blueprint):üìë Vegas CRM Backend Loyihasi TahliliTayyorlovchi: Vegas Development Team (Jigar & AI)Holati: Minimum Viable Product (MVP) - Backend Asosiy QurilmasiBaza: PostgreSQL (Docker)ORM: Drizzle ORMServer: Express.js (TypeScript)I. Global Arxitektura (Decoupled Strategy)Biz loyihaning barqarorligi va tezligi uchun "Gibrid/Ajratilgan" (Decoupled) yechimni tanladik.ElementJoylashuviVazifasiFrontendVercel (CDN)UI/UX taqdim etish (Next.js)BackendEskiz VPSBiznes logikasi (Express.js)DatabaseEskiz VPS (Docker)Ma'lumotlarni saqlash (PostgreSQL)Proksi (Nginx)Eskiz VPS (Host)HTTPS (SSL) ni ta'minlash va api.vegas-xorazm.uz manzilidan Express ga yo'naltirish.üîë Domen ulanishivegas-xorazm.uz ‚û°Ô∏è Vercel (Frontend)api.vegas-xorazm.uz ‚û°Ô∏è Eskiz VPS IP (Backend)II. Kod Strukturasi (Feature-Based / Modular)Loyihaning kengayishini osonlashtirish uchun Feature-Based (Modulli) arxitektura qabul qilindi.PapkaVazifasiMisolsrc/modules/{feature}Barcha funksionallik (Controller, Service, Route) shu yerda joylashgan.src/modules/product/src/routes/index.tsMarkaziy Router. Barcha modul routelarini /api/v1 ostiga yig'adi. server.ts faqat bitta fayl bilan ishlaydi.router.use("/products", productRoutes)src/db/Baza ulanishini boshqaradi.index.ts, schema.tssrc/utils/Global yordamchi klasslar va funksiyalar.ApiError.ts, asyncHandler.ts, logger.tsIII. Drizzle Baza Logikasi va Schema XususiyatlariSchema barcha moliyaviy barqarorlik talablariga javob beradi:Multi-Currency Logic (products, orders):products.currency: Mahsulotning asl narxi qaysi valyutada ekanligi (USD / UZS).orders.exchangeRate: Chek yopilgan vaqtdagi So'm/Dollar kursi saqlanadi. Bu tarixiy foyda hisobotini buzilishdan saqlaydi.Soft Delete (Tarixni saqlash):products.isDeleted (Boolean): Mahsulot o'chirilganda true bo'ladi. U bazada va eski cheklarda qoladi.products.isActive (Boolean): Mahsulotning sotuvda faol ekanligini bildiradi (ombor yoki sezon uchun).barcode: products jadvalida unikal maydon mavjud. Bu tezkor skanerlash va qidiruvni ta'minlaydi.decimal tiplar: Barcha narxlar (price, totalAmount, balance) suzuvchi nuqta (floating point) xatolarini oldini olish uchun aniq decimal (PostgreSQL) tipida saqlanadi.IV. Production & Xavfsizlik Qatlami (Beton Layer)Tizim ishonchli va xavfsiz bo'lishi uchun barcha so'rovlar quyidagi qatlamlardan o'tadi:QatlamFayl / KutubxonaVazifasiSecurityhelmet, cors, rateLimitDDoS, XSS himoyasi, ruxsat berilgan domenlarni (Vercel) cheklash.Validationsrc/middlewares/validate.ts + ZodControllerga kirishdan oldin ma'lumotlarni (body, query, params) tekshiradi va xatolarni ApiErrorga o'tkazadi.Async Flowsrc/utils/asyncHandler.tsBarcha Controller funksiyalarini o'raydi; bu bizga try/catch yozishdan qutqaradi va xatolarni avtomatik next(err) ga uzatadi.Error Handlingsrc/middlewares/errorHandler.tsBarcha kutilmagan/kutilgan xatolarni ushlab oladi. Dasturiy xatolarni logga yozadi, mijozga esa faqat umumiy xabarni qaytaradi (Security).Loggingsrc/utils/logger.ts (Winston)Xavfsizlik uchun console.log o'rniga xatolarni va muhim ma'lumotlarni faylga (error.log) yozadi.Keyingi vazifa (Next Steps)Bizning keyingi qadamimiz ‚Äî Kategoriyalar (Categories) modulini yozish (CRUD), chunki Mahsulot yaratish uchun Kategoriya IDsi kerak bo'ladi.